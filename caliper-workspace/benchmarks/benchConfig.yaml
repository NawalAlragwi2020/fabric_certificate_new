test:
  name: certificate-benchmark-v3-secure
  description: 'إختبار الأداء والأمان باستخدام SHA-3 وتقنية الـ Batching'
  workers:
    type: local
    number: 2
  rounds:
    # 1. اختبار الإصدار (التركيز على الـ Batching)
    - label: Issue-Certificates-SHA3-Batch
      description: إصدار شهادات مجمعة ومشفرة بـ SHA-3
      txDuration: 30
      rateControl:
        type: fixed-rate
        opts:
          tps: 50
      workload:
        module: workload/issueDiplomaBatch.js

    # 2. اختبار الجهد الأقصى (Stress Test)
    - label: Stress-Test-Scaling
      description: اختبار قدرة الشبكة من 50 إلى 400 TPS
      txDuration: 40 
      rateControl:
        type: linear-rate
        opts:
          startingTps: 50
          finishingTps: 400
      workload:
        module: workload/issueDiplomaBatch.js

    # 3. اختبار التحقق الأمني (SHA-3 Integrity Check) - الأهم لرسالتك
    - label: Secure-Verification-SHA3
      description: التحقق اللحظي من الشهادات باستخدام SHA-3
      txDuration: 30
      rateControl:
        type: fixed-rate
        opts:
          tps: 200 # نظامك المطور أثبت قدرته على هذا المعدل
      workload:
        module: workload/verifyDiploma.js

    # 4. الاستعلام المحدود (لتفادي مشكلة الذاكرة في التقرير 17)
    - label: Query-All-Optimized
      description: جلب كافة الأصول بمعدل منخفض لضمان استقرار الذاكرة
      txDuration: 20
      rateControl:
        type: fixed-rate
        opts:
          tps: 5 # تقليل المعدل لتجنب الـ Timeout
      workload:
        module: workload/queryAllDiplomas.js

monitors:
  resource:
    - module: docker
      options:
        interval: 5 
        containers:
          - all 
        charting:
          bar:
            metrics: [Memory(avg), CPU%(avg)]
